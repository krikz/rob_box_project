# System Prompts –¥–ª—è rob_box_perception

–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å system prompts –¥–ª—è Internal Dialogue Agent.

## –§–∞–π–ª—ã

### reflection_prompt.txt
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Å–Ω–æ–≤–Ω–æ–π system prompt –¥–ª—è `reflection_node`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ª–∏—á–Ω–æ—Å—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –≥–æ–ª–æ—Å–∞ —Ä–æ–±–æ—Ç–∞
- –ü—Ä–∞–≤–∏–ª–∞ –∫–æ–≥–¥–∞ –≥–æ–≤–æ—Ä–∏—Ç—å –≤—Å–ª—É—Ö
- –§–æ—Ä–º–∞—Ç JSON –æ—Ç–≤–µ—Ç–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** –≤ `reflection_node`

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
```bash
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç reflection_prompt.txt –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
ros2 run rob_box_perception reflection_node
```

### –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
```bash
# –°–æ–∑–¥–∞—Ç—å —Å–≤–æ–π –ø—Ä–æ–º–ø—Ç
echo "–¢—ã —Ä–æ–±–æ—Ç-—Ñ–∏–ª–æ—Å–æ—Ñ..." > /path/to/custom_prompt.txt

# –ü–æ–ª–æ–∂–∏—Ç—å –≤ prompts/ –∏ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
cp custom_prompt.txt src/rob_box_perception/prompts/
colcon build --packages-select rob_box_perception

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º
ros2 run rob_box_perception reflection_node \
  --ros-args -p system_prompt_file:=custom_prompt.txt
```

### –í launch —Ñ–∞–π–ª–µ
```python
Node(
    package='rob_box_perception',
    executable='reflection_node',
    parameters=[{
        'system_prompt_file': 'reflection_prompt.txt',
        # –∏–ª–∏ 'custom_prompt.txt'
    }]
)
```

### –í Docker
```yaml
environment:
  SYSTEM_PROMPT_FILE: reflection_prompt.txt
```

## –§–æ—Ä–º–∞—Ç –ø—Ä–æ–º–ø—Ç–∞

System prompt –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:

1. **–õ–∏—á–Ω–æ—Å—Ç—å** - –∫—Ç–æ —Ç—ã (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –≥–æ–ª–æ—Å —Ä–æ–±–æ—Ç–∞)
2. **–ó–∞–¥–∞—á–∏** - —á—Ç–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å (–∞–Ω–∞–ª–∏–∑, —Ä–µ—Ñ–ª–µ–∫—Å–∏—è, —Ä–µ—à–µ–Ω–∏–µ)
3. **–ü—Ä–∞–≤–∏–ª–∞** - –∫–æ–≥–¥–∞ –≥–æ–≤–æ—Ä–∏—Ç—å –≤—Å–ª—É—Ö
4. **–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞** - JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### –ü—Ä–∏–º–µ—Ä:
```
–¢—ã - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –≥–æ–ª–æ—Å —Ä–æ–±–æ—Ç–∞ –†–æ–±–ë–æ–∫—Å.

–¢–≤–æ—è –∑–∞–¥–∞—á–∞:
1. –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç (–¥–∞—Ç—á–∏–∫–∏, –∫–∞–º–µ—Ä–∞, –ø–∞–º—è—Ç—å)
2. –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º—ã—Å–ª–∏
3. –†–ï–®–ê–¢–¨: –≥–æ–≤–æ—Ä–∏—Ç—å –≤—Å–ª—É—Ö –∏–ª–∏ –º–æ–ª—á–∞—Ç—å

–ü—Ä–∞–≤–∏–ª–∞ —Ä–µ—á–∏:
- –ì–æ–≤–æ—Ä–∏ –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –≤–∞–∂–Ω–æ
- –ù–ï –±–æ–ª—Ç–∞–π –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫
...

–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ JSON:
{
  "thought": "–≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –º—ã—Å–ª—å",
  "should_speak": true/false,
  "speech": "—Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–∏–∑–Ω–µ—Å–µ–Ω–∏—è"
}
```

## –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (symlink)
```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–π –Ω–∞–ø—Ä—è–º—É—é (–±–ª–∞–≥–æ–¥–∞—Ä—è --symlink-install)
nano src/rob_box_perception/prompts/reflection_prompt.txt

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –Ω–æ–¥—É - –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è
ros2 run rob_box_perception reflection_node
```

### –í Docker
–ü—Ä–æ–º–ø—Ç –≤—Å—Ç—Ä–æ–µ–Ω –≤ –æ–±—Ä–∞–∑ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ. –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:
1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `prompts/reflection_prompt.txt`
2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å Docker –æ–±—Ä–∞–∑
3. –ü–µ—Ä–µ–¥–µ–ø–ª–æ–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

## Fallback

–ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –∏–∑ –∫–æ–¥–∞:
```python
# –í reflection_node.py
def _load_system_prompt(self) -> str:
    try:
        # –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞
        ...
    except Exception as e:
        # Fallback –Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π
        return """–¢—ã - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –≥–æ–ª–æ—Å —Ä–æ–±–æ—Ç–∞..."""
```

**Fallback –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç:** –Ω–æ–¥–∞ –≤—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –¥–∞–∂–µ –µ—Å–ª–∏ —Ñ–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

## Best Practices

1. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π reflection_prompt.txt –¥–ª—è production**
2. ‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–π –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ**
3. ‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä—É–π –ø—Ä–æ–º–ø—Ç—ã –≤ Git**
4. ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–º–º–∏—Ç–∞—Ö**
5. ‚ö†Ô∏è **–ù–µ —É–¥–∞–ª—è–π fallback –ø—Ä–æ–º–ø—Ç –∏–∑ –∫–æ–¥–∞**

## –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç
```bash
# –ó–∞–ø—É—Å—Ç–∏ –Ω–æ–¥—É - –ª–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç —Ä–∞–∑–º–µ—Ä
ros2 run rob_box_perception reflection_node

# –í—ã–≤–æ–¥:
# [INFO] [reflection_node]: ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω prompt: reflection_prompt.txt (1004 –±–∞–π—Ç)
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã
```bash
ls -la install/rob_box_perception/share/rob_box_perception/prompts/
```

### –ü—Ä–æ—á–∏—Ç–∞—Ç—å –ø—Ä–æ–º–ø—Ç
```bash
cat install/rob_box_perception/share/rob_box_perception/prompts/reflection_prompt.txt
```

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å rob_box_voice

| –ê—Å–ø–µ–∫—Ç | rob_box_voice | rob_box_perception |
|--------|---------------|-------------------|
| –§–∞–π–ª | `master_prompt_simple.txt` | `reflection_prompt.txt` |
| –ü–∞—Ä–∞–º–µ—Ç—Ä | `system_prompt_file` | `system_prompt_file` |
| Env var | `SYSTEM_PROMPT_FILE` | `SYSTEM_PROMPT_FILE` |
| Fallback | ‚úÖ –ï—Å—Ç—å | ‚úÖ –ï—Å—Ç—å |
| –§–æ—Ä–º–∞—Ç | SSML JSON | JSON (thought/speech) |

**–ï–¥–∏–Ω—ã–π –ø–æ–¥—Ö–æ–¥!** –û–±–∞ –ø–∞–∫–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.

---

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ
