# TTS Voice Testing Script

Интерактивный скрипт для тестирования и подбора голосов Text-to-Speech на русском языке.

## Возможности

- **Скачивание моделей** - автоматически скачивает все доступные русские модели TTS
- **Интерактивное тестирование** - прослушивание голосов с разными настройками
- **3 TTS движка:**
  - **Piper** (рекомендуется) - neural TTS, быстрый, качественный
  - **Silero** - 4 голоса, хорошее качество, медленнее
  - **RHVoice** - легковесный, но звучит роботизированно

## Установка зависимостей

### Piper (рекомендуется)

```bash
pip install piper-tts
```

### Silero

```bash
pip install torch torchaudio omegaconf
```

### RHVoice

```bash
sudo apt-get install rhvoice rhvoice-russian
```

## Использование

### Интерактивный режим (все движки)

```bash
python3 test_tts_voices.py
```

Скрипт предложит выбрать TTS движок, затем:
1. Выберите голос из списка (1-4)
2. Прослушайте синтезированную речь
3. Смените фразу (`p`) или скорость (`s`)
4. Тестируйте разные голоса

### Конкретный движок

```bash
# Только Piper
python3 test_tts_voices.py --engine piper

# Только Silero
python3 test_tts_voices.py --engine silero

# Только RHVoice
python3 test_tts_voices.py --engine rhvoice
```

### Кастомная директория для моделей

```bash
python3 test_tts_voices.py --models-dir /path/to/models
```

По умолчанию модели сохраняются в `~/.cache/rob_box_voice/tts_models/`

## Доступные голоса

### Piper (2 голоса)

| Голос | Пол | Размер | Описание |
|-------|-----|--------|----------|
| **dmitri** | M | 63 MB | Чёткий, спокойный (рекомендуется для робота) |
| **irina** | F | 63 MB | Тёплый, дружелюбный |

### Silero (4 голоса)

| Голос | Пол | Описание |
|-------|-----|----------|
| **aidar** | M | Нейтральный |
| **baya** | F | Тёплый |
| **kseniya** | F | Энергичный |
| **xenia** | F | Молодой, дружелюбный |

### RHVoice (4 голоса)

| Голос | Пол | Описание |
|-------|-----|----------|
| aleksandr | M | Классический |
| anna | F | Нейтральный |
| elena | F | Приятный |
| irina | F | Тёплый |

**Примечание:** RHVoice использует формантный синтез и звучит роботизированно (не рекомендуется).

## Тестовые фразы

Скрипт использует следующие фразы для тестирования:

1. "Привет! Я голосовой ассистент робота Роббокс."
2. "Еду вперёд. Скорость полметра в секунду."
3. "Заряд батареи семьдесят восемь процентов."
4. "Обнаружено препятствие на расстоянии один метр."
5. "Поворачиваю налево на девяносто градусов."
6. "Система навигации готова. Ожидаю команды."

Смена фразы: нажмите `p` в меню.

## Настройка скорости

Скорость синтеза можно изменить в меню (`s`):
- Диапазон: 0.5-2.0
- По умолчанию: 1.0
- Для робота рекомендуется: 0.8-1.2

## Примеры

### Быстрое тестирование Piper dmitri

```bash
python3 test_tts_voices.py --engine piper
# Выбрать: 1 (dmitri)
# Прослушать
# Изменить скорость: s -> 0.9
# Прослушать снова
```

### Сравнение всех голосов Silero

```bash
python3 test_tts_voices.py --engine silero
# Тестируем все 4 голоса по очереди
# Выбираем лучший для робота
```

## Рекомендация для ROBBOX

**Лучший выбор:** Piper - dmitri, скорость 1.0

**Причины:**
- ✅ Качественный neural TTS
- ✅ Чёткая дикция (важно для команд)
- ✅ Спокойный тон (подходит роботу)
- ✅ Быстрый синтез (<0.5s)
- ✅ Малый размер (63 MB)

**Альтернатива:** Silero - baya (если нужен женский голос)

## Интеграция в rob_box_voice

После выбора голоса обновите конфигурацию:

```yaml
# config/voice_assistant.yaml
tts_node:
  provider: "piper"
  piper:
    model_path: "/models/ru_RU-dmitri-medium.onnx"
    voice_speed: 1.0  # Или выбранная скорость
```

## Troubleshooting

### Ошибка "ModuleNotFoundError: No module named 'piper'"

```bash
pip install piper-tts
```

### Ошибка "ModuleNotFoundError: No module named 'torch'"

```bash
pip install torch torchaudio
```

### Ошибка "RHVoice-test: command not found"

```bash
sudo apt-get install rhvoice rhvoice-russian
```

### Модели не скачиваются (wget ошибка)

```bash
# Проверьте интернет-соединение
ping github.com

# Или скачайте вручную и поместите в ~/.cache/rob_box_voice/tts_models/
```

### Нет звука при воспроизведении

```bash
# Проверьте ALSA
aplay -l

# Проверьте что устройство не занято
lsof /dev/snd/*

# Проверьте громкость
alsamixer
```

## Размер кэша

После скачивания всех моделей:

| Движок | Размер |
|--------|--------|
| Piper (2 голоса) | ~126 MB |
| Silero (модель + 4 голоса) | ~300 MB |
| RHVoice | ~50 MB (установка через apt) |

**Итого:** ~476 MB для всех движков

**Рекомендуется:** Скачать только Piper (~126 MB)

---

**Дата:** 2025-01-12  
**Автор:** GitHub Copilot  
**Статус:** Ready for testing ✅
